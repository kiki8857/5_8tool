# 铣刀寿命预测系统

基于PHM 2010数据集的铣刀寿命预测系统，包括数据预处理、特征提取、特征选择和模型训练等模块。

## 项目结构

```
├── data                       # 数据目录
│   ├── raw                    # 原始数据
│   ├── processed              # 预处理后的数据
│   ├── features               # 提取的特征
│   └── selected_features      # 选择的特征
│
├── models                     # 模型目录
│   ├── bpnn                   # BP神经网络模型
│   ├── lstm                   # LSTM模型
│   └── ensemble               # 集成模型
│
└── src                        # 源代码
    ├── data_preprocessing.py  # 数据预处理模块
    ├── feature_extraction.py  # 特征提取模块
    ├── feature_selection.py   # 特征选择模块
    ├── bpnn_model.py          # BP神经网络模型
    ├── lstm_model.py          # LSTM模型
    └── ensemble_model.py      # 集成模型
```

## 系统流程

1. **数据预处理**：
   - 读取PHM_2010原始切削数据
   - 使用Z-score方法移除异常值
   - 应用Butterworth低通滤波进行降噪
   - 使用移动平均、Savitzky-Golay或指数平滑处理
   - 标准化数据

2. **特征提取**：
   - 时域特征：均值、标准差、RMS、峰值等
   - 频域特征：使用FFT提取
   - 时频域特征：使用连续小波变换提取
   - 小波包特征
   - 特征与磨损值关联并可视化

3. **特征选择**：
   - 使用过滤法：相关系数、互信息
   - 使用包装法：递归特征消除(RFE)
   - 使用嵌入法：随机森林、LASSO
   - 组合多种方法的结果
   - 选择10个左右的最关键特征

4. **模型训练与评估**：
   - BP神经网络模型
   - LSTM时间序列模型
   - 集成模型（随机森林、XGBoost、梯度提升、Stacking）
   - 使用c1和c4的数据训练，c6的数据测试

## 实验结果

### 特征选择结果

每个刀具选择了约10个最重要的特征，但不同刀具间的特征存在差异。三个刀具共有的特征仅有3个。

### 模型性能比较

| 模型 | MSE | RMSE | MAE | R² |
|------|-----|------|-----|---|
| 随机森林 | 795.48 | 28.20 | 23.68 | 0.474 |
| 梯度提升 | 799.01 | 28.27 | 24.63 | 0.471 |
| Stacking | 905.77 | 30.10 | 26.15 | 0.401 |
| XGBoost | 965.10 | 31.07 | 26.62 | 0.362 |
| LSTM | 5298.97 | 72.79 | 61.82 | -2.506 |
| BPNN | 14059979.04 | 3749.66 | 2850.19 | -18855.64 |

## 结论

1. 传统机器学习模型在铣刀磨损预测任务上表现优于深度学习模型。
2. 随机森林模型表现最好，R²达到0.474。
3. 更多共同特征和改进的特征选择策略可能会进一步提高模型性能。

## 未来工作

1. 探索更多的特征组合和特征选择方法。
2. 尝试不同的深度学习架构，如CNN-LSTM混合模型。
3. 考虑迁移学习，使用其他刀具的数据来提高目标刀具的预测精度。
4. 实现模型部署和在线预测功能。 
